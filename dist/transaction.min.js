function searchTransactions(t){$(".transaction-item").each(function(){$(this).text().search(new RegExp(t,"i"))<0?$(this).hide():$(this).show()})}function resetSearchBar(){let t=$("#transaction-search-bar .search-input-cont"),a=$("#transaction-search-bar #clear");$(a).hasClass("hidden")||$(a).addClass("hidden"),$(t).removeClass("search-offset"),searchTransactions("")}function getStatusClass(t){switch(t){case"paid-out":return"status-payed";case"in-progress":return"status-pending";default:return"status-rejected"}}function setStatusIcon(t){switch(t){case"paid-out":return'<span class="material-icons status-icon status-payed">done</span>';case"in-progress":return'<span class="material-icons status-icon status-pending">hourglass_bottom</span>';default:return'<span class="material-icons status-icon status-error">do_not_disturb_on</span>'}}function parseTransactions(){let t=[];return $("#view_61 .kn-list-content .kn-list-item-container, #view_62 .kn-list-content .kn-list-item-container").each(function(){let a={};$(this).find(".kn-detail").each(function(){let t=$(this).attr("class").split(" "),s=$(this).find(".kn-detail-label span span").text(),n=t.find(t=>t.includes("field")),e=$(this).find(".kn-detail-body span span").text();"field_59"!==n&&"field_23"!==n&&"field_148"!==n||(e=$(this).find(".kn-detail-body span span span").text());let i="";"field_23"===n&&(i=$(this).find(".kn-detail-body span span span").attr("class"));let l="";"field_148"===n&&(l=$(this).find(".kn-detail-body span span span").attr("class")),a[n]={label:s,value:e,..."field_23"===n&&{class:i},..."field_148"===n&&{class:l}}});var s=$(this).find(".kn-details-link a").attr("href");a.edit=s,t.push(a)}),t}function formatDate(t){let a=t.split("/"),s=new Date(+a[2],a[1]-1,+a[0]),n=s.getFullYear();return`${s.toLocaleString("default",{month:"long"})} ${s.getDate()<10?"0"+s.getDate():s.getDate()}, ${n}`}function createDetailRows(t){let a="";for(const s in t){if("field_64"===s||"edit"===s)continue;if("field_148"===s&&"paid-out"!=t.field_23.class)continue;let n=t[s].value;if("field_24"===s){let t=formatDate(n.substring(0,10)),a=n.substring(10,n.length);n=t.concat(" at",a)}a+=`\n            <div class="ti-content-row">\n                <span class="ti-row-label">\n                    ${t[s].label}\n                </span>\n\n                <span class="ti-row-value ${"field_23"===s&&getStatusClass(t[s].class)}">\n                    ${n||"-"}\n                </span>\n            </div>\n        `}return a}function createTransactionList(){let t=parseTransactions(),a=$(".transaction-list-container");t.forEach(t=>{let s=formatDate(t.field_24.value.substring(0,10));var n="not-paid"==t.field_148.class&&"paid-out"==t.field_23.class?"":"display: none;",e="uploaded"==t.field_148.class&&"paid-out"==t.field_23.class?"":"display: none;",i="paid"==t.field_148.class&&"paid-out"==t.field_23.class?"":"display: none;";let l=`\n            <div class="transaction-item ${getStatusClass(t.field_23.class)}">\n                <div class="ti-header">\n                    <div class="ti-header-tgl">\n                        <span class="ti-withdrawal-date">${s}</span>\n                        <span class="btn-toggle material-icons">expand_more</span>\n                    </div>\n\n                    <div class="ti-header-amount">\n                        <span class="ti-amount">${t.field_18.value}</span>\n                        <a class="upload-payslip" style="${n}" href="${t.edit}">Payback</a>\n                        <a class="pending-approval" style="${e}">Pending Approval</a>\n                        <a class="paid" style="${i}">Paid</a>\n                        ${setStatusIcon(t.field_23.class)}\n                    </div>\n                </div>\n\n                <div class="ti-contnet hidden-detail">\n                    ${createDetailRows(t)}\n                </div>\n            </div>`;a.append(l)})}function setupEventHandlers(){$(".transaction-item .btn-toggle").click(function(){let t=$(this).parents(".transaction-item");$(this).toggleClass("selected"),$(t).find(".ti-contnet").toggleClass("hidden-detail"),$("html, body").animate({scrollTop:$(t).offset().top+$(t).height()/3},1e3)}),$("#transaction-search-bar input").keyup(function(){let t=$(this).parents(".custom-search-bar"),a=$(t).find(".search-input-cont"),s=$(t).find("#clear"),n=$(this).val().trim();""!==n?($(s).removeClass("hidden"),$(a).hasClass("search-offset")||$(a).addClass("search-offset"),searchTransactions(n)):resetSearchBar()}),$("#transaction-search-bar #clear").click(function(){let t=$(this).parents(".custom-search-bar"),a=$(t).find("input.form-input");$(a).val(""),resetSearchBar()})}function loadCustomTrasactionView(){createTransactionList(),setupEventHandlers()}