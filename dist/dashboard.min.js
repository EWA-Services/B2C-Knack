requests_check=function(e,t,a,s,r){if("-"==e||"-"==t)var n=!1;else{var i=new Date(t.split("/")[2],t.split("/")[1]-1,t.split("/")[0]),l=new Date(e.split("/")[2],e.split("/")[1]-1,e.split("/")[0]),d=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),o=i;o.setDate(o.getDate()-r);n=d>=o&&d<=l}var c={};$("#view_52 .kn-report-content table tbody tr").each(function(){var e=$(this).find(".kn-pivot-group").text().trim(),t=parseInt($(this).find(".kn-pivot-calc:eq(1)").text().trim());c[e]=t});var p=0;for(var u of Object.keys(c))if(new Date(2022,u.split("/")[1]-1,u.split("/")[0])>new Date(t.split("/")[2],t.split("/")[1]-1,t.split("/")[0]))p=p+c[u];var v=a<=0||p<a,_={};$("#view_146 table tbody tr").each(function(){var e=$(this).find(".kn-pivot-group span").attr("class"),t=parseInt($(this).find(".kn-pivot-calc").text().trim());_[e]=t});var y=0==_["not-paid"],w=0==_.uploaded,m=0!=s;return n&&v&&y&&w&&m?{status:!0}:0==m?{status:!1,error:"Advances are not allowed at the moment."}:0==y?{status:!1,error:"Please pay back the advance you have received to be able to submit a new request."}:0==w?{status:!1,error:"Please wait until your payslips are approved to be able to submit a new request."}:0==n?{status:!1,error:"Salary advances are only available starting "+r+" days before your next payday. Please come back later."}:0==v?{status:!1,error:"You have reached the maximum number of advance requests for this month. You can request a new advance after you received your next salary."}:void 0};var current_month=(new Date).getFullYear()+"-"+((new Date).getMonth()+1<10?"0"+((new Date).getMonth()+1):(new Date).getMonth()+1),payday="-",cutoff_day="-",months=$("#view_96 .kn-table tbody td.field_88 span"),paydays=$("#view_96 .kn-table tbody td.field_76 span"),cutoffs=$("#view_96 .kn-table tbody td.field_82 span");$.each(months,function(e,t){t.textContent.trim()==current_month&&(payday=paydays[e].textContent.trim()||"-",cutoff_day=cutoffs[e].textContent.trim()||"-")});var base_salary=parseFloat(""==$("#view_51 .field_44 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_51 .field_44 .kn-detail-body").text().replace(/,/g,"")),requested_amount=parseFloat(""==$("#view_52 .kn-pivot-calc:eq(0)").text().replace(/,/g,"")?0:$("#view_52 .kn-pivot-calc:eq(0)").text().replace(/,/g,"")),max_number_requests=parseFloat(""==$("#view_68 .field_91 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_68 .field_91 .kn-detail-body").text().replace(/,/g,"")),withdrawable_threshold=parseFloat(""==$("#view_68 .field_89 .kn-detail-body").text().replace(/,/g,"")?0:$("#view_68 .field_89 .kn-detail-body").text().replace(/,/g,"")),max_per_request=parseFloat(""==$("#view_51 .kn-detail.field_105 .kn-detail-body span span").text().replace(/,/g,"")?0:$("#view_51 .kn-detail.field_105 .kn-detail-body span span").text().replace(/,/g,"")),days_to_request=parseInt(""==$("#view_51 .kn-detail.field_149 .kn-detail-body span span").text().replace(/,/g,"")?0:$("#view_51 .kn-detail.field_149 .kn-detail-body span span").text().replace(/,/g,"")),current_date=new Date,mtd=current_date.getDate()-1,tot=new Date(current_date.getFullYear(),current_date.getMonth()+1,0).getDate(),balance=base_salary*mtd/tot,available_amount=balance-requested_amount,check=requests_check(cutoff_day,payday,max_number_requests,max_per_request,days_to_request),html='<section id="custom-view-scene1"><div class="payday-wrapper"><div><div class="payday-label">Next Payday</div><div class="payday-value">'+payday+'</div><span class="cutoff-message"><i>Cut-off at '+cutoff_day+'</i></span></div><img src="https://app.ewa-services.com/ewa/images/ico-calendar.svg"/></div><div class="max-withdrawable"><div class="max-withdrawable-label">Maximum Withdrawable Amount</div><div class="max-amount-button"><span>'+(!0===check.status?(Math.round(100*Math.min(max_per_request,available_amount*withdrawable_threshold))/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):0)+"</span><a"+(!0===check.status?' href="'+window.location.pathname+'#request"':' style="pointer-events:none;" class="disabled"')+">Withdraw</a></div>"+(!0===check.status?"":"<p class='error-message'>"+check.error+"</p>")+"</div></section>";$(html).insertBefore($("#kn-scene_1"));